---
title: "Comment : ouvrir un modèle à partir du fichier de Code de programme | Documents Microsoft"
ms.custom: 
ms.date: 11/04/2016
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: d7d68697-5418-4263-bdb2-48401924ea71
caps.latest.revision: "8"
author: alancameronwills
ms.author: awills
manager: douge
ms.workload: multiple
ms.openlocfilehash: 49059888851ec3f153c27f9109ccea107d0961b8
ms.sourcegitcommit: 32f1a690fc445f9586d53698fc82c7debd784eeb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 12/22/2017
---
# <a name="how-to-open-a-model-from-file-in-program-code"></a>Comment : ouvrir un modèle depuis un fichier dans le code de programme
Vous pouvez ouvrir les modèles DSL dans n’importe quelle application.  
  
 À partir d’un [!INCLUDE[vsprvs](../code-quality/includes/vsprvs_md.md)] extension, vous pouvez utiliser ModelBus à cet effet. ModelBus fournit un mécanisme standard pour faire référence à un modèle ou éléments dans un modèle et pour la recherche du modèle si elle a été déplacée. Pour plus d’informations, consultez [intégration de modèles à l’aide de Visual Studio Modelbus](../modeling/integrating-models-by-using-visual-studio-modelbus.md).  
  
## <a name="target-framework"></a>Framework cible  
 Définir le **framework cible** de votre projet d’application pour **.NET Framework 4**.  
  
#### <a name="to-set-the-target-framework"></a>Pour définir le framework cible  
  
1.  Ouvrez le [!INCLUDE[vsprvs](../code-quality/includes/vsprvs_md.md)] projet pour l’application dans laquelle vous souhaitez lire un modèle DSL.  
  
2.  Dans **l’Explorateur de solutions**, cliquez sur le projet, puis sur **propriétés**.  
  
3.  Dans la fenêtre Propriétés du projet, sur le **Application** onglet, définissez la **framework cible** au champ **.NET Framework 4**.  
  
> [!NOTE]
>  Vous devrez peut-être procéder de même si vous avez sélectionné **.NET Framework 4** dans la boîte de dialogue de création de projet. Le framework cible ne doit pas être **.NET Framework 4 Client Profile**.  
  
## <a name="references"></a>Références  
 Vous devez ajouter ces références à votre [!INCLUDE[vsprvs](../code-quality/includes/vsprvs_md.md)] projet d’application :  
  
-   `Microsoft.VisualStudio.Modeling.Sdk.11.0`  
  
    -   Si vous ne voyez pas sous le **.NET** onglet dans le **ajouter des références** boîte de dialogue, cliquez sur le **Parcourir** onglet et accédez à `%Program Files%\Microsoft Visual Studio 2010 SDK\VisualStudioIntegration\Common\Assemblies\`.  
  
-   Votre assembly DSL, que vous trouverez sous le dossier bin du projet de votre DSL. Son nom est en général sous la forme : *votresociété*. *VotreProjet*`.Dsl.dll`.  
  
## <a name="important-classes-in-the-dsl"></a>Classes importantes dans la DSL  
 Avant de pouvoir écrire le code qui lit votre DSL, vous devez connaître les noms de certaines des classes générées par votre DSL. Dans votre solution DSL, ouvrez le **Dsl** de projet et le consulter dans le **GeneratedCode** dossier. Ou bien, double-cliquez sur l’assembly DSL dans votre projet **références**, ouvrez l’espace de noms DSL **Explorateur d’objets**.  
  
 Ce sont les classes, vous devez identifier :  
  
-   *YourDslRootClass* -il s’agit du nom de la classe racine dans votre `DslDefinition.dsl`.  
  
-   *YourDslName* `SerializationHelper` -cette classe est définie dans `SerializationHelper.cs` dans votre projet DSL.  
  
-   *YourDslName* `DomainModel` -cette classe est définie dans `DomainModel.cs` dans votre projet DSL.  
  
## <a name="reading-from-a-file"></a>La lecture à partir d’un fichier  
 L’exemple suivant est conçu pour lire une DSL dans lequel les classes importantes sont les suivantes :  
  
-   FamilyTreeModel  
  
-   FamilyTreeSerializationHelper  
  
-   FamilyTreeDomainModel  
  
 La classe de domaine dans ce DSL est la personne.  
  
```  
using System;  
using Microsoft.VisualStudio.Modeling;  
using Company.FamilyTree; // Your DSL namespace  
  
namespace StandaloneReadDslConsole  
{ class Program  
  { static void Main(string[] args)  
    {  
      // The path of a DSL model file:  
      string dslModel = @"C:\FamilyTrees\Tudor.ftree";  
      // Set up the Store to read your type of model:  
      Store store = new Store(  
        typeof(Company.FamilyTree.FamilyTreeDomainModel));  
      // The Model type generated by the DSL:  
      FamilyTreeModel familyTree;  
      // All Store changes must be in a Transaction:  
      using (Transaction t =   
        store.TransactionManager.BeginTransaction("Load model"))  
      {  
        familyTree =   
           FamilyTreeSerializationHelper.Instance.  
              LoadModel(store, dslModel, null, null, null);  
        t.Commit(); // Don't forget this!  
      }  
      // Now we can read the model:  
      foreach (Person p in familyTree.People)  
      {  
        Console.WriteLine(p.Name);   
        foreach (Person child in p.Children)  
        {  
          Console.WriteLine("    " + child.Name);  
        }  
} } } }  
```  
  
## <a name="saving-to-a-file"></a>Enregistrement dans un fichier  
 Les configurations suivantes pour le code précédent apporte une modification au modèle et puis l’enregistre dans un fichier.  
  
```  
using (Transaction t =  
  store.TransactionManager.BeginTransaction("update model"))  
{  
  // Create a new model element:  
  Person p = new Person(store);  
  // Set its embedding relationship:  
  p.FamilyTreeModel = familyTree;  
  // - same as: familyTree.People.Add(p);  
  // Set its properties:  
  p.Name = "Edward VI";  
  t.Commit(); // Don't forget this!  
}  
// Save the model:  
try  
{  
  SerializationResult result = new SerializationResult();  
  FamilyTreeSerializationHelper.Instance  
    .SaveModel(result, familyTree, @"C:\FamilyTrees\Tudor-upd.ftree");  
  // Report any error:  
  if (result.Failed)  
  {  
    foreach (SerializationMessage message in result)  
    {  
      Console.WriteLine(message);  
    }  
  }  
}  
catch (System.IO.IOException ex)  
{ ... }  
```